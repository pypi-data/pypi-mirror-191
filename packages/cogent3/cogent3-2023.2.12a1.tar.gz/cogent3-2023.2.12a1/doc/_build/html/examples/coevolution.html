<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Perform a coevolutionary analysis on biological sequence alignments &#8212; cogent3 2022.10.31a1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="../_static/require.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis of rate heterogeneity" href="rate_heterogeneity.html" />
    <link rel="prev" title="Performing a parametric bootstrap" href="parametric_bootstrap.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Docs</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../install.html">Install</a></li>
                <li><a href="../draw/index.html">Gallery</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Sections <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../app/index.html">The <code class="docutils literal notranslate"><span class="pre">apps</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/index.html">Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Perform a coevolutionary analysis on biological sequence alignments</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="parametric_bootstrap.html" title="Previous Chapter: Performing a parametric bootstrap"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Performing a ...</span>
    </a>
  </li>
  <li>
    <a href="rate_heterogeneity.html" title="Next Chapter: Analysis of rate heterogeneity"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Analysis of r... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="perform-a-coevolutionary-analysis-on-biological-sequence-alignments">
<h1>Perform a coevolutionary analysis on biological sequence alignments<a class="headerlink" href="#perform-a-coevolutionary-analysis-on-biological-sequence-alignments" title="Permalink to this headline">¶</a></h1>
<p><em>Section author: Greg Caporaso</em></p>
<p>This document describes how to perform a coevolutionary analysis on a <code class="docutils literal notranslate"><span class="pre">ArrayAlignment</span></code> object. Coevolutionary analyses identify correlated substitution patterns between <code class="docutils literal notranslate"><span class="pre">ArrayAlignment</span></code> positions (columns). Several coevolution detection methods are currently provided via the Cogent3 coevolution module. <code class="docutils literal notranslate"><span class="pre">ArrayAlignment</span></code> objects must always be used as input to these functions.</p>
<p>Before using an alignment in a coevolutionary analysis, you should be confident in the alignment. Poorly aligned sequences can yield very misleading results. There can be no ambiguous residue/base codes (e.g., B/Z/X in protein alignments) – while some of the algorithms could tolerate them (e.g. Mutual Information), others which rely on information such as background residue frequencies (e.g. Statistical Coupling Analysis) cannot handle them. Some recoded amino acid alphabets will also not handle ambiguous residues. The best strategy is just to exclude ambiguous codes all together. To test for invalid characters before starting an analysis you can do the following:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3</span> <span class="kn">import</span> <span class="n">make_aligned_seqs</span>
<span class="kn">from</span> <span class="nn">cogent3.core.alignment</span> <span class="kn">import</span> <span class="n">ArrayAlignment</span>
<span class="kn">from</span> <span class="nn">cogent3.evolve.coevolution</span> <span class="kn">import</span> <span class="n">validate_alignment</span>

<span class="n">aln</span> <span class="o">=</span> <span class="n">make_aligned_seqs</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;GAA&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;CTA&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;CTC&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;-TC&quot;</span><span class="p">},</span>
    <span class="n">moltype</span><span class="o">=</span><span class="s2">&quot;protein&quot;</span><span class="p">,</span>
    <span class="n">array_align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">validate_alignment</span><span class="p">(</span><span class="n">aln</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To run a coevolutionary analysis, first create a <code class="docutils literal notranslate"><span class="pre">ArrayAlignment</span></code>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3</span> <span class="kn">import</span> <span class="n">make_aligned_seqs</span>
<span class="kn">from</span> <span class="nn">cogent3.core.alignment</span> <span class="kn">import</span> <span class="n">ArrayAlignment</span>

<span class="n">aln</span> <span class="o">=</span> <span class="n">make_aligned_seqs</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;CTA&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;CTC&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;-TC&quot;</span><span class="p">},</span>
    <span class="n">moltype</span><span class="o">=</span><span class="s2">&quot;protein&quot;</span><span class="p">,</span>
    <span class="n">array_align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Perform a coevolutionary analysis on a pair of positions in the alignment using mutual information (<code class="docutils literal notranslate"><span class="pre">mi</span></code>):</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.evolve.coevolution</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">coevolve_pair</span><span class="p">,</span>
    <span class="n">coevolve_pair_functions</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">coevolve_pair</span><span class="p">(</span><span class="n">coevolve_pair_functions</span><span class="p">[</span><span class="s2">&quot;mi&quot;</span><span class="p">],</span> <span class="n">aln</span><span class="p">,</span> <span class="n">pos1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0.31127812445913294
</pre></div>
</div>
</div>
</div>
<p>Perform a coevolutionary analysis on a pair of positions in the alignment using statistical coupling analysis (<code class="docutils literal notranslate"><span class="pre">sca</span></code>):</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.evolve.coevolution</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">coevolve_pair</span><span class="p">,</span>
    <span class="n">coevolve_pair_functions</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">coevolve_pair</span><span class="p">(</span><span class="n">coevolve_pair_functions</span><span class="p">[</span><span class="s2">&quot;sca&quot;</span><span class="p">],</span> <span class="n">aln</span><span class="p">,</span> <span class="n">pos1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0.980536895536287
</pre></div>
</div>
</div>
</div>
<p>Perform a coevolutionary analysis on one position and all other positions in the alignment using mutual information (<code class="docutils literal notranslate"><span class="pre">mi</span></code>):</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.evolve.coevolution</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">coevolve_position</span><span class="p">,</span>
    <span class="n">coevolve_position_functions</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">coevolve_position</span><span class="p">(</span><span class="n">coevolve_position_functions</span><span class="p">[</span><span class="s2">&quot;mi&quot;</span><span class="p">],</span> <span class="n">aln</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([       nan, 0.81127812, 0.31127812])
</pre></div>
</div>
</div>
</div>
<p>Perform a coevolutionary analysis on all pairs of positions in the alignment using mutual information (<code class="docutils literal notranslate"><span class="pre">mi</span></code>):</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.evolve.coevolution</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">coevolve_alignment</span><span class="p">,</span>
    <span class="n">coevolve_alignment_functions</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">coevolve_alignment</span><span class="p">(</span><span class="n">coevolve_alignment_functions</span><span class="p">[</span><span class="s2">&quot;mi&quot;</span><span class="p">],</span> <span class="n">aln</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[       nan,        nan,        nan],
       [       nan, 0.81127812, 0.31127812],
       [       nan, 0.31127812, 1.        ]])
</pre></div>
</div>
</div>
</div>
<p>View the available algorithms for computing coevolution values:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">coevolve_pair_functions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;mi&#39;, &#39;nmi&#39;, &#39;rmi&#39;, &#39;sca&#39;, &#39;an&#39;])
</pre></div>
</div>
</div>
</div>
<p>Perform an intermolecular coevolutionary analysis using mutual information (<code class="docutils literal notranslate"><span class="pre">mi</span></code>). Note that there are strict requirements on the sequence identifiers for intermolecular analyses, and some important considerations involved in preparing alignments for these analyses. See the coevolve_alignments docstring (i.e., <code class="docutils literal notranslate"><span class="pre">help(coevolve_alignments)</span></code> from the python interpreter) for information. Briefly, sequence identifiers are split on <code class="docutils literal notranslate"><span class="pre">+</span></code> symbols. The ids before the + must match perfectly between the two alignments as these are used to match the sequences between alignments. In the following example, these are common species names: human, chicken, echidna, and pig. The text after the <code class="docutils literal notranslate"><span class="pre">+</span></code> can be anything, and should probably be the original database identifiers of the sequences.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.evolve.coevolution</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">coevolve_alignment_functions</span><span class="p">,</span>
    <span class="n">coevolve_alignments</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">aln1</span> <span class="o">=</span> <span class="n">make_aligned_seqs</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;human+protein1&quot;</span><span class="p">:</span> <span class="s2">&quot;AAA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pig+protein1&quot;</span><span class="p">:</span> <span class="s2">&quot;CTA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;chicken+protein1&quot;</span><span class="p">:</span> <span class="s2">&quot;CTC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;echidna+weird_db_identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;-TC&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">moltype</span><span class="o">=</span><span class="s2">&quot;protein&quot;</span><span class="p">,</span>
    <span class="n">array_align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">aln2</span> <span class="o">=</span> <span class="n">make_aligned_seqs</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;pig+protein2&quot;</span><span class="p">:</span> <span class="s2">&quot;AAAY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;chicken+protein2&quot;</span><span class="p">:</span> <span class="s2">&quot;CTAY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;echidna+protein2&quot;</span><span class="p">:</span> <span class="s2">&quot;CTCF&quot;</span><span class="p">,</span>
        <span class="s2">&quot;human+protein2&quot;</span><span class="p">:</span> <span class="s2">&quot;-TCF&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">moltype</span><span class="o">=</span><span class="s2">&quot;protein&quot;</span><span class="p">,</span>
    <span class="n">array_align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">coevolve_alignments</span><span class="p">(</span><span class="n">coevolve_alignment_functions</span><span class="p">[</span><span class="s2">&quot;mi&quot;</span><span class="p">],</span> <span class="n">aln1</span><span class="p">,</span> <span class="n">aln2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[       nan,        nan,        nan],
       [       nan, 0.12255625, 0.31127812],
       [       nan, 0.31127812, 0.        ],
       [       nan, 0.31127812, 0.        ]])
</pre></div>
</div>
</div>
</div>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020-2023, cogent3 Team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>