Developers must review upload functionality to determine if uploaded content is ever returned to other application users and whether that is due to normal application usage or attack manipulation. As a part of this revision, developers should consider:

- If the application filters file extensions and the MIME type of the uploaded file.
- If placing executable JavaScript or HTML into the file is possible.
- If the header information is returned after the contents of a file are downloaded.
- If the storage location for uploaded content is escapable with a crafted filename.

There are numerous steps toward a more robust upload code architecture that developers must consider in their design:

- Developers must use an allow list, enforcing acceptance of only listed, non-executable file extensions.
- Developers should ensure file names do not contain directory traversal characters such as ../ that are used to place files outside of designated directory locations.
- Developers should alter permissions on the upload folder to ensure the files canâ€™t be executed.
- Uploads must not be placed in directories that are accessible from the web.
- Developers should ensure that if uploaded files are downloaded by users, they contain `X-Content-Type-options: nosniff` header and a `Content-Disposition` header that commands browsers to handle files as an attachment.
- Uploaded files should be subject to immediate virus scanning.
- Developers must enforce size limits on uploaded files and reject archive formats (like ZIP) from being uploaded at all.
