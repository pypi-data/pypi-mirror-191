Die Entwickler müssen die Upload-Funktionalität überprüfen, um festzustellen, ob hochgeladene Inhalte jemals an andere Benutzer der Anwendung zurückgegeben werden und ob dies auf eine normale Nutzung der Anwendung oder auf eine Manipulation durch Angreifer zurückzuführen ist. Im Rahmen dieser Überprüfung sollten die Entwickler berücksichtigen:

- Ob die Anwendung Dateierweiterungen und den MIME-Typ der hochgeladenen Datei filtert.
- Ob es möglich ist, ausführbares JavaScript oder HTML in der Datei zu platzieren.
- Ob die Header-Informationen zurückgegeben werden, nachdem der Inhalt einer Datei heruntergeladen wurde.
- Wenn der Speicherort für hochgeladene Inhalte mit einem manipulierten Dateinamen entschlüsselt werden kann.

Es gibt zahlreiche Schritte auf dem Weg zu einer robusteren Upload-Code-Architektur, die Entwickler bei ihrem Entwurf berücksichtigen müssen:

- Die Entwickler müssen eine Erlaubnisliste verwenden, die nur aufgelistete, nicht ausführbare Dateierweiterungen zulässt.
- Die Entwickler sollten sicherstellen, dass die Dateinamen keine Zeichen für den Verzeichniswechsel enthalten, wie z. B. ../, die verwendet werden, um Dateien außerhalb der vorgesehenen Verzeichnisse zu platzieren.
- Entwickler sollten die Berechtigungen für den Upload-Ordner ändern, um sicherzustellen, dass die Dateien nicht ausgeführt werden können.
- Uploads dürfen nicht in Verzeichnissen platziert werden, die über das Internet zugänglich sind.
- Entwickler sollten sicherstellen, dass hochgeladene Dateien, wenn sie von Benutzern heruntergeladen werden, den Header "X-Content-Type-options: nosniff" und einen Header "Content-Disposition" enthalten, der Browsern befiehlt, Dateien als Anhang zu behandeln.
- Hochgeladene Dateien sollten sofort einer Virenprüfung unterzogen werden.
- Die Entwickler müssen Größenbeschränkungen für hochgeladene Dateien durchsetzen und verhindern, dass Archivformate (wie ZIP) überhaupt hochgeladen werden.
