The best way to fix and prevent this vulnerability is to replace the calls to the system/shell with calls to the API of the programming language.

You should replace calls like `exec` or `system` with the matching function provided by your programming language. For instance, instead of using something like `system("rm $file");` to delete a file, use `remove($file);`. Typical functions you should avoid are `exec`, `system` and `call`.

If that is not an option, you should escape what is passed to those calls to ensure no malicious commands are executed. Each language will have its own escape functions, such as `escapeshellcmd` for PHP or `shellescape` for Ruby.

Finally, if the previous mitigations are not an option, you should strongly consider to _whitelist_ the characters that may be passed as argument to the function to avoid including malicious commands. To implement the _whitelist_ start by allowing only alphanumerical characters. You may allow more characters, but do not allow characters like `&`, `|`, `;` or `=`. In addition, run your application with the lowest privileges possible, and never as `root`.
