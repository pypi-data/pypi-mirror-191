If possible, developers should avoid building file path strings with user-provided input. Many functions of an application can be rewritten to deliver functionally identical behavior but in a safer manner.

If passing user-supplied input to a filesystem API is absolutely necessary, developers must ensure the following:

- Validate the user input by strictly accepting well-known, reputable candidates against an allow list
-  If validating against an allow list isnâ€™t possible, validation should at least ensure that only permitted content is contained in the input

As defense in depth, developers should never run a server component with *root* or *SYSTEM* privileges, as this can enable access to any file or folder, including crypto keys and the registry, to a malicious actor exploiting this vulnerability. Server components should be run using a less-privileged user with no access to critical system files.